{
    "preset":{
        "default":{
            "description":"Default preset",
            "action":{
                "info":{},
                "copy":{},
                "move":{},
                "delete":{},
                "prepare":{},
                "explode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "mode":"select",
                            "branch":[
                                {"kind":"mkv"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"he"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"default",
                                                "profile":"original"
                                            },
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"clean",
                                                "profile":"clean"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"en"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"default",
                                                "profile":"original"
                                            },
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"clean",
                                                "profile":"clean"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"chp"
                                            }
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "mode":"select",
                            "branch":[
                                {"kind":"m4v"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"chp"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                "pack":{
                    "pivot":[
                        { "operator":"this" },
                        { "operator":"select", "constraint":{"kind":"srt"} },
                        { "operator":"select", "constraint":{"kind":"chp"} },
                        { "operator":"select", "constraint":{"kind":"ac3"} }
                    ],
                    "transform":[
                        {
                            "description":"Hebrew and english subtitles from the clean profile",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt", "profile":"clean"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"he"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"en"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                }
                            ]
                        },
                        {
                            "description":"First of hebrew or english subtitles as swedish",
                            "mode":"choose",
                            "branch":[
                                {"kind":"srt", "profile":"clean", "language":"he"},
                                {"kind":"srt", "profile":"clean", "language":"en"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption"}
                                    ],
                                    "override":{"stream name":"Smart", "language":"sv"}
                                }
                            ]
                        },
                        {
                            "description":"First of hebrew or english or other chapter track",
                            "mode":"choose",
                            "branch":[
                                {"kind":"chp", "language":"he"},
                                {"kind":"chp", "language":"en"},
                                {"kind":"chp"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ]
                                }
                            ]
                        },
                        {
                            "description":"Audio and video streams from a matroska file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"},
                                {"kind":"avi"}
                            ],
                            "override":{
                                "mkvmerge flags":[
                                    "--no-global-tags",
                                    "--no-track-tags",
                                    "--no-chapters",
                                    "--no-attachments",
                                    "--no-subtitles"
                                ]
                            },
                            "track":[
                                {
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"video"},
                                        {"stream kind":"audio", "kind":"ac3"},
                                        {"stream kind":"audio", "kind":"aac"},
                                        {"stream kind":"audio", "kind":"dts"},
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"mp3"}
                                    ]
                                }
                            ]
                        }
                    ]
                },
                "tag":{},
                "optimize":{},
                "transcode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "description":"png or jpg artwork",
                            "mode":"choose",
                            "branch":[
                                {"kind":"png"},
                                {"kind":"jpg"}
                            ],
                            "track":[
                                {
                                    "description":"Transcode image to png",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"image"}
                                    ],
                                    "override":{
                                        "max length":1024
                                    }
                                }
                            ]
                        },
                        {
                            "description":"raw dts audio stream to ac3",
                            "mode":"choose",
                            "branch":[
                                {"kind":"dts"}
                            ],
                            "track":[
                                {
                                    "description":"Transcode 6 channels dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":6}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"448k", "-acodec":"ac3", "-ac":6 }
                                    }
                                },
                                {
                                    "description":"Transcode 5 channels dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":5}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"448k", "-acodec":"ac3", "-ac":5 }
                                    }
                                },
                                {
                                    "description":"Transcode 4 channels dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":4}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"448k", "-acodec":"ac3", "-ac":4 }
                                    }
                                },
                                {
                                    "description":"Transcode 3 channels dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":3}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"448k", "-acodec":"ac3", "-ac":3 }
                                    }
                                },
                                {
                                    "description":"Transcode stereo dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":2}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"256k", "-acodec":"ac3", "-ac":2 }
                                    }
                                },
                                {
                                    "description":"Transcode mono dts to ac3",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts", "channels":1}
                                    ],
                                    "override":{
                                        "ffmpeg parameters":{"-ab":"192k", "-acodec":"ac3", "-ac":1 }
                                    }
                                }
                            ]
                        },
                        {
                            "description":"subtitles",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt"},
                                {"kind":"ass"}
                            ],
                            "track":[
                                {
                                    "description":"Hebrew subtitles",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption"}
                                    ]
                                }
                            ]
                        },
                        {
                            "description":"menu",
                            "mode":"select",
                            "branch":[
                                {"kind":"chp"}
                            ],
                            "track":[
                                {
                                    "description":"menu",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ]
                                }
                            ]
                        }
                    ]
                },
                "update":{
                    "pivot":[
                        { "operator":"select", "constraint":{"kind":"srt"} },
                        { "operator":"select", "constraint":{"kind":"chp"} },
                        { "operator":"select", "constraint":{"kind":"png"} }
                    ],
                    "transform":[
                        {
                            "description":"All hebrew and english subtitles of the clean profile",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt", "profile":"clean"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"he"}
                                    ],
                                    "override":{"stream name":"Normal", "height":0.132}
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"en"}
                                    ],
                                    "override":{"stream name":"Normal", "height":0.132}
                                }
                            ]
                        },
                        {
                            "description":"First of hebrew or english subtitles as swedish",
                            "mode":"choose",
                            "branch":[
                                {"kind":"srt", "profile":"clean", "language":"he"},
                                {"kind":"srt", "profile":"clean", "language":"en"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption"}
                                    ],
                                    "override":{"stream name":"Smart", "height":0.148, "language":"sv"}
                                }
                            ]
                        },
                        {
                            "description":"First of hebrew or english artwork",
                            "mode":"choose",
                            "branch":[
                                {"kind":"png", "profile":"normal", "language":"he"},
                                {"kind":"png", "profile":"normal", "language":"en"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"image"}
                                    ]
                                }
                            ]
                        },
                        {
                            "description":"First of hebrew or english chapter track",
                            "mode":"choose",
                            "branch":[
                                {"kind":"chp", "language":"he"},
                                {"kind":"chp", "language":"en"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "ac3audio":{
            "description":"A preset for prepare to explode, transcode DTS and FLAC tracks to AC3 and repack the fragments",
            "action":{
                "explode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "mode":"select",
                            "branch":[
                                {"kind":"mkv"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"he"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"default",
                                                "profile":"original"
                                            },
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"clean",
                                                "profile":"clean"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"en"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"default",
                                                "profile":"original"
                                            },
                                            {
                                                "action":"transcode",
                                                "kind":"srt",
                                                "preset":"clean",
                                                "profile":"clean"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"dts"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "routing type":"fragment",
                                                "kind":"ac3"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "routing type":"fragment",
                                                "kind":"ac3"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ],
                                    "override":{
                                        "routing type":"fragment",
                                        "tasks":[
                                            {
                                                "action":"transcode",
                                                "kind":"chp"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                },
                "pack":{
                    "pivot":[
                        { "operator":"this" },
                        { "operator":"fragments" }
                    ],
                    "transform":[
                        {
                            "description":"Subtitles",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                }
                            ]
                        },
                        {
                            "description":"Chapters",
                            "mode":"choose",
                            "branch":[
                                {"kind":"chp"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ]
                                }
                            ]
                        },
                        {
                            "description":"Raw ac3",
                            "mode":"select",
                            "branch":[
                                {"kind":"ac3"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                }
                            ]
                        },
                        {
                            "description":"Audio and video streams from the main file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"},
                                {"kind":"avi"}
                            ],
                            "override":{
                                "mkvmerge flags":[
                                    "--no-global-tags",
                                    "--no-track-tags",
                                    "--no-chapters",
                                    "--no-attachments",
                                    "--no-subtitles"
                                ]
                            },
                            "track":[
                                {
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"video"},
                                        {"stream kind":"audio", "kind":"ac3"},
                                        {"stream kind":"audio", "kind":"aac"},
                                        {"stream kind":"audio", "kind":"dts"},
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"mp3"}
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "fragment":{
            "description":"Pack only the fragments of a file",
            "action":{
                "pack":{
                    "pivot":[
                        { "operator":"this" },
                        { "operator":"fragments" }
                    ],
                    "transform":[
                        {
                            "description":"Subtitles",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                }
                            ]
                        },
                        {
                            "description":"Chapters",
                            "mode":"choose",
                            "branch":[
                                {"kind":"chp"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"menu"}
                                    ]
                                }
                            ]
                        },
                        {
                            "description":"Raw ac3",
                            "mode":"select",
                            "branch":[
                                {"kind":"ac3"}
                            ],
                            "track":[
                                {
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"}
                                    ],
                                    "override":{"stream name":"Normal"}
                                }
                            ]
                        },
                        {
                            "description":"Audio and video streams from the main file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"},
                                {"kind":"avi"}
                            ],
                            "override":{
                                "mkvmerge flags":[
                                    "--no-global-tags",
                                    "--no-track-tags",
                                    "--no-chapters",
                                    "--no-attachments",
                                    "--no-subtitles"
                                ]
                            },
                            "track":[
                                {
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"video"},
                                        {"stream kind":"audio", "kind":"ac3"},
                                        {"stream kind":"audio", "kind":"aac"},
                                        {"stream kind":"audio", "kind":"dts"},
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"mp3"}
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "clean":{
            "description":"Clean preset for cleaning subtitles",
            "action":{
                "transcode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "description":"subtitles",
                            "mode":"select",
                            "branch":[
                                {"kind":"srt"},
                                {"kind":"ass"}
                            ],
                            "track":[
                                {
                                    "description":"Hebrew subtitles",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"he"}
                                    ],
                                    "override":{
                                        "subtitle filters":["noise", "hebrew noise", "typo", "punctuation", "leftover"]
                                    }
                                },
                                {
                                    "description":"English subtitles",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"caption", "language":"en"}
                                    ],
                                    "override":{
                                        "subtitle filters":["noise", "typo", "english typo", "leftover"]
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "atv3":{
            "description":"Apple TV 3 transcoding presets",
            "action":{
                "transcode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "description":"Audio and video streams from a matroska or m4v file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"}
                            ],
                            "override":{
                                "profile":"High@L4.0"
                            },
                            "track":[
                                {
                                    "description":"Transcode the main video track to H.264",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"video"}
                                    ],
                                    "override":{
                                        "handbrake parameters":{
                                            "--pfr":null,
                                            "--rate":30,
                                            "--large-file":null,
                                            "--loose-anamorphic":null,
                                            "--quality":18,
                                            "--modulus":2,
                                            "--maxHeight":1080,
                                            "--maxWidth":1920,
                                            "--encoder":"x264",
                                            "--x264-profile":"high",
                                            "--h264-level":"4.0",
                                            "--x264-preset":"slow"
                                        },
                                        "handbrake x264 settings":{
                                            "subme":9,
                                            "trellis":2,
                                            "vbv-bufsize":31250,
                                            "vbv-maxrate":25000
                                        }
                                    }
                                },
                                {
                                    "description":"Copy aac and ac3 audio tracks",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"},
                                        {"stream kind":"audio", "kind":"aac"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"copy", "--ab":"auto", "--mixdown":"auto"}
                                    }
                                },
                                {
                                    "description":"Transcode 6,5 and 4 channels flac or dts to 448kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":6},
                                        {"stream kind":"audio", "kind":"flac", "channels":5},
                                        {"stream kind":"audio", "kind":"flac", "channels":4},
                                        {"stream kind":"audio", "kind":"dts", "channels":6},
                                        {"stream kind":"audio", "kind":"dts", "channels":5},
                                        {"stream kind":"audio", "kind":"dts", "channels":4}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":448}
                                    }
                                },
                                {
                                    "description":"Transcode 3 and 2 channels flac or dts to 256kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":3},
                                        {"stream kind":"audio", "kind":"flac", "channels":2},
                                        {"stream kind":"audio", "kind":"dts", "channels":3},
                                        {"stream kind":"audio", "kind":"dts", "channels":2}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":256}
                                    }
                                },
                                {
                                    "description":"Transcode 1 channel flac or dts to 192kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":1},
                                        {"stream kind":"audio", "kind":"dts", "channels":1}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":192}
                                    }
                                },
                                {
                                    "description":"Transcode flac or dts to 256kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"dts"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":256, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode ac3 to 160kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":160, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode mp3 or vorbis stereo tracks to 128kbps stereo aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":2},
                                        {"stream kind":"audio", "kind":"ogg", "channels":2}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":128, "--mixdown":"stereo"}
                                    }
                                },
                                {
                                    "description":"Transcode mono mp3 or vorbis tracks to 64kbps mono aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":1},
                                        {"stream kind":"audio", "kind":"ogg", "channels":1}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":64, "--mixdown":"mono"}
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "atv2":{
            "description":"Apple TV 2 transcoding presets",
            "action":{
                "transcode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "description":"Audio and video streams from a matroska or m4v file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"}
                            ],
                            "override":{
                                "profile":"High@L3.1"
                            },                            
                            "track":[
                                {
                                    "description":"Transcode the main video track to H.264",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"video"}
                                    ],
                                    "override":{
                                        "handbrake parameters":{
                                            "--pfr":null,
                                            "--rate":30,
                                            "--large-file":null,
                                            "--loose-anamorphic":null,
                                            "--quality":18,
                                            "--modulus":2,
                                            "--maxHeight":720,
                                            "--maxWidth":1280,
                                            "--encoder":"x264",
                                            "--x264-profile":"high",
                                            "--h264-level":"3.1",
                                            "--x264-preset":"slow"
                                        },
                                        "handbrake x264 settings":{
                                            "subme":9,
                                            "trellis":2,
                                            "vbv-bufsize":17500,
                                            "vbv-maxrate":17500
                                        }
                                    }
                                },
                                {
                                    "description":"Copy aac and ac3 audio tracks",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"},
                                        {"stream kind":"audio", "kind":"aac"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"copy", "--ab":"auto", "--mixdown":"auto"}
                                    }
                                },
                                {
                                    "description":"Transcode 6,5 and 4 channels flac or dts to 448kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":6},
                                        {"stream kind":"audio", "kind":"flac", "channels":5},
                                        {"stream kind":"audio", "kind":"flac", "channels":4},
                                        {"stream kind":"audio", "kind":"dts", "channels":6},
                                        {"stream kind":"audio", "kind":"dts", "channels":5},
                                        {"stream kind":"audio", "kind":"dts", "channels":4}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":448}
                                    }
                                },
                                {
                                    "description":"Transcode 3 and 2 channels flac or dts to 256kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":3},
                                        {"stream kind":"audio", "kind":"flac", "channels":2},
                                        {"stream kind":"audio", "kind":"dts", "channels":3},
                                        {"stream kind":"audio", "kind":"dts", "channels":2}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":256}
                                    }
                                },
                                {
                                    "description":"Transcode 1 channel flac or dts to 192kbps ac3",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac", "channels":1},
                                        {"stream kind":"audio", "kind":"dts", "channels":1}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ac3", "--ab":192}
                                    }
                                },
                                {
                                    "description":"Transcode flac or dts to 256kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"dts"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":256, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode ac3 to 160kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":160, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode mp3 or vorbis stereo tracks to 128kbps stereo aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":2},
                                        {"stream kind":"audio", "kind":"ogg", "channels":2}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":128, "--mixdown":"stereo"}
                                    }
                                },
                                {
                                    "description":"Transcode mono mp3 or vorbis tracks to 64kbps mono aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":1},
                                        {"stream kind":"audio", "kind":"ogg", "channels":1}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":64, "--mixdown":"mono"}
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "iphone":{
            "description":"iPhone transcoding presets",
            "action":{
                "transcode":{
                    "pivot":[
                        { "operator":"this" }
                    ],
                    "transform":[
                        {
                            "description":"Audio and video streams from a matroska or m4v file",
                            "mode":"choose",
                            "branch":[
                                {"kind":"mkv"},
                                {"kind":"m4v"}
                            ],
                            "override":{
                                "profile":"High@L3.1"
                            },
                            "track":[
                                {
                                    "description":"Transcode the main video track to H.264",
                                    "mode":"choose",
                                    "branch":[
                                        {"stream kind":"video"}
                                    ],
                                    "override":{
                                        "handbrake parameters":{
                                            "--pfr":null,
                                            "--rate":30,
                                            "--large-file":null,
                                            "--loose-anamorphic":null,
                                            "--quality":20,
                                            "--modulus":2,
                                            "--maxHeight":640,
                                            "--maxWidth":960,
                                            "--encoder":"x264",
                                            "--x264-profile":"high",
                                            "--h264-level":"3.1",
                                            "--x264-preset":"slow"
                                        },
                                        "handbrake x264 settings":{
                                            "subme":9,
                                            "trellis":2,
                                            "vbv-bufsize":17500,
                                            "vbv-maxrate":17500
                                        }
                                    }
                                },
                                {
                                    "description":"Copy aac audio tracks",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"aac"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"copy", "--ab":"auto", "--mixdown":"auto"}
                                    }
                                },
                                {
                                    "description":"Transcode flac or dts to 256kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"flac"},
                                        {"stream kind":"audio", "kind":"dts"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":256, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode ac3 to 160kbps Dolby Pro Logic II aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"ac3"}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":160, "--mixdown":"dpl2"}
                                    }
                                },
                                {
                                    "description":"Transcode mp3 or vorbis stereo tracks to 128kbps stereo aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":2},
                                        {"stream kind":"audio", "kind":"ogg", "channels":2}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":128, "--mixdown":"stereo"}
                                    }
                                },
                                {
                                    "description":"Transcode mono mp3 or vorbis tracks to 64kbps mono aac",
                                    "mode":"select",
                                    "branch":[
                                        {"stream kind":"audio", "kind":"mp3", "channels":1},
                                        {"stream kind":"audio", "kind":"ogg", "channels":1}
                                    ],
                                    "override":{
                                        "handbrake audio encoder settings":{"--aencoder":"ca_aac", "--ab":64, "--mixdown":"mono"}
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        }
    }
}
